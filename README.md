# ExtensionFilter

Extension Filter Project for flow.team by 박영서
 

## 아키텍처 설계

[!img](이미지 주소)

### 클라이언트(Vite, http://43.200.6.17:5173)
본 과제를 진행하기 위해서, 파일 확장자를 차단하기 위한 아키텍처를 구상해보았습니다.

우선, 파일 확장자 차단에 대한 화면을 제공하는 프론트엔드 단을 react+vite를 구상하였습니다.

프론트엔드에서는 화면을 새로고침할 때마다 GET 요청을 서버에 보내
 
서버에게 확장자 목록을 받아서 고정 확장자의 체크박스 유무와 커스텀 확장자를 표시합니다.

체크박스에 체크를 하거나, 커스텀 확장자에 추가를 하면 POST요청을 보내고,

체크박스를 해제하거나, 커스텀 확장자 박스의 x를 눌러 지우면 DELETE 요청을 보냅니다.

EC2 인스턴스에서 Nginx에 의해 띄어집니다.

### 서버(Spring, http://43.200.6.17:8888)
[!img](스웨거 이미지)
서버는 Springboot를 사용하여 구현하였습니다.

Spring에서는 차단 확장자의 Create, Read, Delete에 필요한 Restful API를 제공합니다.

CrossOrigin을 사용하여 오직 클라이언트(또는 부하 테스트를 진행하는 로컬)만이 API에 접근할도록 하였습니다.


### 캐시 서버(Redis, http://43.200.6.17:6379)
이번 과제에서 구현의 중심입니다.

클라이언트로부터 빠르고 많은 쓰기/지우기 요청이 들어올 경우를 대비하기 위해 설계되었습니다.

데이터베이스의 접근과 작업을 최소화시킵니다.


### 데이터베이스(Mysql, flow.c7yq02g6gdsd.ap-northeast-2.rds.amazonaws.com:3306)
차단 확장자를 저장하는 DB입니다. AWS RDS를 사용하여 EC2와 연결되어있습니다.

## 시행착오
이번 과제에서 아마 가장 중요했던 건, 얼마나 빠르고 많은 쓰기/지우기 요청을 어떻게 처리하는 것이 효율적인지 고민하였습니다.

그래서 처음에 구상했던 것은, 서버에서 버튼을 누를 때마다 요청을 보내는 것이 아니라, 어느 정도의 텀을 두고서 요청을 보내는 것이었습니다.

결국 마지막 요청만이 의미 있는 요청이기에, 그것만 처리하면 되므로, 디바운스라는, 특정 시간 동안 아무 행동이 없을 때 실질적인 요청을 보내는 모듈을 사용하였습니다.

그렇게 하여 실질적으로 의미 있는 요청을 보내도록 하였습니다.

또한 백엔드단에서는 이를 가장 효율적으로 처리하기 위해서는,

무조건 DB로 요청을 보내는 것이 아니라, 캐시로만 작업을 하다가 특정 시간이 되면 요청들을 큐에 모아서 일괄 처리하는 캐싱 + 배치 작업을 구상하였으나, 높은 구현 난이도와 복잡한 캐싱 관리 이슈로, 단순 캐싱을 통해서 최대한 DB로의 접근을 최소화하고자 하였습니다.

대신에, Grafana K6라는 부하 테스트 도구를 사용하여 실제로 어느 정도의 성능 향상을 기대할 수 있는지 확인할 수 있었습니다.

또한, 이를 ChatGPT한테 분석을 요청하였고 실제로도 10배정도의 성능 향상이 나타났습니다.
[!img](k6)